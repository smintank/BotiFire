# Оповещатель (ТГ-бот)

Бот для оповещения работников на суточной работе или с ненормированным рабочим днем о том когда они работают.

### ТЗ минимально работающего продукта:
 
##### Варианты начальных пользовательских действий: 

- ~~/start~~
- ~~/help~~
- ~~/menu ("Оповестить", "Замена")~~
- ~~Текст~~
---
- ~~SQLite - для хранения данных пользователей~~
- ~~Фильтрация пользователей (middleware) - запрос в бд авторизован ли пользователь~~
- Если пишет - парсинг - если там: 00, 0, o, oo, ок, хорошо, принял, ноль, нули, спасибо, спс. 
проверить не оповещали ли его. Возможно реализовать через InlineKeyboard
- Если да то менять флаг на "Оповещен"
- Кнопка заменить и никто не был назначен, выводится сообщение "Ещё никого не оповещали"
- Кнопка заменить - вывести меню с постами
- Сообщение "Кто заступает на {пост}?"
- Парсинг (если провал то сообщение "Сотрудник с такой фамилией, либо не распознан, либо вы ошиблись")
- Сверка с бд есть ли такой пользователь
- Проверить не оповещен ли он уже на другой пост
- Создать список сегодняшнего оповещения
- Записывать в бд кто оповестил
- Если замена то оповестить что человек не работает завтра
- Оповестить того кто работает
- Повторить со всеми постами
- 


### Идеи на будущее:

- Анти флуд (middleware)
- Админка (middleware)
- Инструкция для тех кто не сидит в телеграме




Работа бота:
1. /start - Пользователю высвечивается приветствие и предложение настроить под себя бот в виде инлайн кнопок
   1. Если да то машина состояний запоминает ответы и прогоняет вопросы с вариантами ответв
   2. Если нет то настройки по умолчанию и вывести меню
2. /menu - состоит из пунктов: Что вы хотите сделать?

3. Если оповестить - отправляется меню с постами
   1. Выбирает пост, пост запоминается
   2. Отправить меню с фамилиями
   3. Выбирает - ему присылается результат для подтверждения с кнопками
      [['Следующий'], ['Закончить', 'Отмена']]
      1. Если 'Следующий' то выводится снова выбор постов, но уже без постов на которые назначен сотрудник
      2. Если Закончить то вывести подтверждение для всех оповещаемых
      3. Если отмена то вопрос отменить всё или только последнее
         1. Если всё то выводим сообщение и замолкаем
         2. Если последнее то удаляем последнюю запись и выводим номера постов заново
4. Если Информация то выбрать из меню
   [['Довести информацию'], ['Где я завтра работаю?'], [Назад]]
   1. Если Довести то запускается череда вопросов для сбора данных от пользователя
      1. Введите текст:
      2. Выберите кого оповестить [[Всех], [На выходном], [Не в отпуске], [Вручную]]
         1. Если Всех то всем
         2. Если на выходном то вывести список для проверки
         3. Если не в отпуске то вывести список для проверки
         4. Если вручную то вывести список с фамилиями
            1. Если выбирает то добавлять зыездочку к имени и внизу кнопка 'Оповестить N человек' и 'Отмена'
               1. Если нажал то оповестить или отменить
      3. Если закончил то добавить в меню кнопку 'Статус оповещения'
   2. Если где я завтра работаю прислать график
   3. Если назад то предидущее меню
5. Если досуг то выбрать какой [[Спорт], [Праздник], [Другое]]
   1. Если Спорт то выбрать какой [Футбол], [Волейбол], [Качалка], [Другое]
      1. Выбор времени и даты 
      2. Отправка всем кто подписан на данные мероприятия
   2. Если Праздник
      1. Выбираем дату и время
      2. Добавляем описание
      3. Выбираем кому из списка фамилий
      4. Подтверждаем или отменяем
   3. Если другое то
      1. Выбираем дату и время
      2. Добавляем описание
      3. Выбираем кому из списка фамилий
      4. Подтверждаем или отменяем
6. Тревога
   1. Номера телефонов всех кто не в отпуске и не на смене
   2. Отмечать фамилии прибывших с выводом статистики и времени прибытия
7. Прочее
   1. Настройки
   2. Сбор денег
   3. Назад
